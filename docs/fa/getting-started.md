# شروع کار

## پیش‌نیازها

شما به **دو سرور** نیاز دارید:

| سرور      | موقعیت      | نقش                                     |
| --------- | ----------- | --------------------------------------- |
| `EDGE`    | منطقه محدود | نقطه ورود که کاربران به آن متصل می‌شوند |
| `GATEWAY` | منطقه آزاد  | نقطه خروج با دسترسی آزاد به اینترنت     |

**چرا دو سرور؟**

کاربران در شبکه‌های ایزوله نمی‌توانند مستقیماً به بسیاری از وبسایت‌ها دسترسی داشته باشند. این ابزار یک زنجیره ایجاد می‌کند:

1. دستگاه شما به سرور **EDGE** (در منطقه شما) متصل می‌شود
2. EDGE ترافیک را به سرور **GATEWAY** (منطقه آزاد) ارسال می‌کند
3. GATEWAY محتوا را از اینترنت دریافت می‌کند
4. پاسخ برمی‌گردد: اینترنت ← GATEWAY ← EDGE ← دستگاه شما

```
[محدود]                     [آزاد]
شما --> سرور EDGE      -->  سرور GATEWAY   -->  اینترنت
        (دیتاسنتر محلی)      (منطقه آزاد)         (سایت‌های مسدود)
```

**مزایای این روش:**

- سرور EDGE تاخیر کمی دارد (نزدیک شماست)
- سرور GATEWAY دسترسی آزاد به اینترنت دارد
- ترافیک بین EDGE و GATEWAY رمزنگاری شده است
- اگر EDGE مسدود شود، به راحتی می‌توانید آن را عوض کنید

**نیازمندی‌های سرور:**

- Debian/Ubuntu با دسترسی root
- حداقل 512MB RAM، 1 CPU

برای پیشنهاد VPS به [ارائه‌دهندگان](providers.md) مراجعه کنید.

## دانلود

روی هر دو سرور GATEWAY و EDGE اجرا کنید:

```bash
curl -sL https://raw.githubusercontent.com/dalirnet/xray-chain-proxy/main/script.sh -o xcp.sh
chmod +x xcp.sh
```

## راه‌اندازی Gateway

روی سرور خروجی (با اینترنت آزاد):

```bash
./xcp.sh setup gateway
```

تنظیمات:

- پورت Shadowsocks (پیش‌فرض: 443)
- پورت HTTP (پیش‌فرض: 80)
- پورت SOCKS5 (پیش‌فرض: 1080)

اطلاعات خروجی را ذخیره کنید:

```
GATEWAY Ready!

Use on EDGE server:
  IP:         1.2.3.4
  SS Port:    443
  Password:   xxxxxxxxxxxxxxxx
```

## راه‌اندازی Edge

روی سرور ورودی:

```bash
./xcp.sh setup edge
```

اطلاعات GATEWAY را وارد کنید:

- آی‌پی Gateway
- پورت Gateway (443)
- رمز عبور Gateway

## اتصال کلاینت‌ها

### Shadowsocks

از هر کلاینت Shadowsocks استفاده کنید:

| تنظیم    | مقدار           |
| -------- | --------------- |
| Server   | آی‌پی EDGE      |
| Port     | 443             |
| Password | (از راه‌اندازی) |
| Method   | `aes-256-gcm`   |

### HTTP Proxy

```
http://username:password@EDGE_IP:80
```

### SOCKS5 Proxy

```
socks5://username:password@EDGE_IP:1080
```

## تست اتصال

روی سرور EDGE:

```bash
./xcp.sh test
```

آی‌پی خروجی (باید آی‌پی GATEWAY باشد) و تست سرعت نمایش داده می‌شود.
