# Xray Chain Proxy

> **نسخه 2.1.0**

یک راه‌حل قدرتمند پروکسی زنجیره‌ای برای دور زدن سانسور اینترنت، بر پایه [Xray-core](https://github.com/XTLS/Xray-core).

## نحوه عملکرد

| سرور      | موقعیت      | نقش                                           |
| --------- | ----------- | --------------------------------------------- |
| `EDGE`    | منطقه محدود | نقطه ورود - کاربران به اینجا متصل می‌شوند     |
| `GATEWAY` | منطقه آزاد  | نقطه خروج - محتوا را از اینترنت دریافت می‌کند |

**چرا دو سرور؟**

کاربران در شبکه‌های ایزوله نمی‌توانند مستقیماً به بسیاری از وبسایت‌ها دسترسی داشته باشند. این ابزار یک زنجیره ایجاد می‌کند:

1. دستگاه شما به سرور **EDGE** (در منطقه شما) متصل می‌شود
2. EDGE ترافیک را به سرور **GATEWAY** (منطقه آزاد) ارسال می‌کند
3. GATEWAY محتوا را از اینترنت دریافت می‌کند
4. پاسخ برمی‌گردد: اینترنت ← GATEWAY ← EDGE ← دستگاه شما

**مزایا:**

- سرور EDGE تاخیر کمی دارد (نزدیک شماست)
- سرور GATEWAY دسترسی آزاد به اینترنت دارد
- ترافیک بین EDGE و GATEWAY رمزنگاری شده است
- اگر EDGE مسدود شود، به راحتی می‌توانید آن را عوض کنید

## پروتکل‌های پشتیبانی شده

| پروتکل      | پورت | روش/احراز هویت | بهترین برای                       |
| ----------- | ---- | -------------- | --------------------------------- |
| Shadowsocks | 443  | `aes-256-gcm`  | اپلیکیشن‌های موبایل، سازگاری بالا |
| HTTP        | 80   | Basic auth     | افزونه‌های مرورگر، curl           |
| SOCKS5      | 1080 | Basic auth     | برنامه‌ها، پروکسی سیستمی          |

> همه پروتکل‌ها از یک نام کاربری و رمز عبور استفاده می‌کنند.

## امکانات

- **پشتیبانی چند پروتکلی** - Shadowsocks، HTTP و SOCKS5 روی یک سرور
- **معماری زنجیره‌ای** - چندین هاپ برای پایداری و حریم خصوصی
- **رمزنگاری قوی** - AES-256-GCM برای اتصالات Shadowsocks
- **مدیریت کاربران** - ایجاد حساب‌های نامحدود با QR کد
- **آمار ترافیک** - نظارت بر پهنای باند هر کاربر
- **CLI ساده** - دستورات به سبک Docker

## پیش‌نیازها

**نیازمندی‌های سرور:**

- Debian/Ubuntu با دسترسی root
- حداقل 512MB RAM، 1 CPU

برای پیشنهاد VPS به صفحه ارائه‌دهندگان مراجعه کنید.

## نصب

### 1. دانلود

روی **هر دو** سرور GATEWAY و EDGE اجرا کنید:

```bash
curl -sL https://raw.githubusercontent.com/dalirnet/xray-chain-proxy/main/script.sh -o xcp.sh
chmod +x xcp.sh
```

### 2. راه‌اندازی Gateway

روی سرور خروجی (با اینترنت آزاد):

```bash
./xcp.sh setup gateway
```

تنظیمات:

- پورت Shadowsocks (پیش‌فرض: 443)
- پورت HTTP (پیش‌فرض: 80)
- پورت SOCKS5 (پیش‌فرض: 1080)

اطلاعات خروجی را ذخیره کنید:

```
GATEWAY Ready!

Use on EDGE server:
  IP:         1.2.3.4
  SS Port:    443
  Password:   xxxxxxxxxxxxxxxx
```

### 3. راه‌اندازی Edge

روی سرور ورودی:

```bash
./xcp.sh setup edge
```

اطلاعات GATEWAY را وارد کنید:

- آی‌پی Gateway
- پورت Gateway (443)
- رمز عبور Gateway

## اتصال کلاینت‌ها

### Shadowsocks

از هر کلاینت Shadowsocks استفاده کنید:

| تنظیم    | مقدار           |
| -------- | --------------- |
| Server   | آی‌پی EDGE      |
| Port     | 443             |
| Password | (از راه‌اندازی) |
| Method   | `aes-256-gcm`   |

برای اپلیکیشن‌های پیشنهادی صفحه کلاینت‌ها را ببینید.

### HTTP Proxy

```
http://username:password@EDGE_IP:80
```

### SOCKS5 Proxy

```
socks5://username:password@EDGE_IP:1080
```

## تست اتصال

روی سرور EDGE:

```bash
./xcp.sh test
```

آی‌پی خروجی (باید آی‌پی GATEWAY باشد) و تست سرعت نمایش داده می‌شود.

## دستورات رایج

```bash
./xcp.sh start          # شروع سرویس
./xcp.sh stop           # توقف سرویس
./xcp.sh status         # نمایش وضعیت
./xcp.sh user ls        # لیست کاربران
./xcp.sh user add       # افزودن کاربر
./xcp.sh stats          # آمار ترافیک
./xcp.sh update         # بروزرسانی
```

برای مستندات کامل صفحه دستورات را ببینید.

## لینک‌ها

- [مستندات Xray-core](https://xtls.github.io/)
- [مخزن پروژه](https://github.com/dalirnet/xray-chain-proxy)
- [گزارش مشکلات](https://github.com/dalirnet/xray-chain-proxy/issues)
